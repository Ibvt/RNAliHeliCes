<p>
	A thermodynamic matcher (TDM) is a specialized RNA folding program. Instead of spanning the complete search space of general RNA folding, a TDM spans only a defined subset of it. This subset might be defined via a graphical description (see <a href="http://bioinformatics.oxfordjournals.org/cgi/content/abstract/23/13/i392">Locomotif: From Graphical Motif Description to RNA Motif Search</a>) or via a shape string (see <a href="http://bioinformatics.oxfordjournals.org/content/26/5/632.short">Faster computation of exact RNA shape probabilities</a>).
</p>
<p>
	&quot;Algebras/alg_tdm.gap&quot; is for the later one. Given a shape string of a specific shape level, we have to generate a specialized grammar out of one of the four prototype grammars <a href="?id=gra_nodangle.gap">Grammars/gra_nodangle.gap</a> <a href="?id=gra_overdangle.gap">Grammars/gra_overdangle.gap</a> <a href="?id=gra_microstate.gap">Grammars/gra_microstate.gap</a> or <a href="?id=gra_macrostate.gap">Grammars/gra_macrostate.gap</a>. This process itself is done with a GAP-L program. So one could say a GAP program generates a GAP program. Due to modularity it only generates the grammar, algebras, signatures and instances could simply be re-used.
</p>
<p>
	After the given shape string has been parsed by one of the grammars from <a href="?id=gra_tdm.gap">Grammars/gra_tdm.gap</a>, the candidate(s) must be transformed into a GAP-L grammar, which is specialized to enumerate only those RNA structures that fold into the given shape. All 20 (4 grammars * 5 levels) algebras, defined in &quot;Algebras/alg_tdm.gap&quot;, are for that transformation. To avoid duplication of rules in the generated grammars, we use the special data type <a href="?id=rules.hh">rules</a>. We heavily use &quot;extends&quot; to avoid implementing the same functions several times. E.g. the algebras for the nodangle prototype are identical to overdangle algebras, except the <code>convert</code> function, which sets the name of the grammar.
	<p>For TDMs the rules must be indexed. We do so by using sub-shape strings, but have to convert <code>[</code> to <code>L</code> and <code>]</code> to <code>J</code> characters to fit GAP-L's requirements for valid non-terminal identifiers.
</p>
<p>Please have a look at the application <a href="?id=Rapidshapes">RapidShapes</a>, to see TDMs in action.</p>