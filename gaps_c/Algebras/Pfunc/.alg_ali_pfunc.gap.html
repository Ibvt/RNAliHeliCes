&quot;Algebras/Pfunc/alg_ali_pfunc.gap&quot; computes the partition function value for a candidate, where the input is an alignment of RNAs. As well as for <a href="?id=alg_ali_mfe.gap">Algebras/MFE/alg_ali_pfunc.gap</a> functions have to iterate through all alignment rows and RNA structures might change. We cannot keep energy and covariance as separate components, because it is unclear how to express zero covariance with Boltzmann's formula. Separation would cause problems with stochastic sampling.