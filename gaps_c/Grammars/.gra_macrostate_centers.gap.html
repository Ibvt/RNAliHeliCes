A shape analysis is position unspecific (see <a href="http://nar.oupjournals.org/cgi/content/abstract/32/16/4843">Abstract Shapes of RNA</a>). If a sequence forms a hairpin at its very beginning or at its end, both alternatives are tied to the same shape: <code>[]</code> For some applications it is necessary to track the positions of the centers of hairpins, bulges, internal loops or multiloops. See <a href="http://rnajournal.cshlp.org/content/early/2012/10/24/rna.033548.112.short">Abstract folding space analysis based on helices</a> for details. This grammar is a specialized version of <a href="?id=gra_macrostate.gap">Grammars/gra_macrostate.gap</a> for the computation of the probability of hairpin centers. In order to do so, the search space must be extended, such that a structure has exactly one and only one tagged hairpin, whilst all other hairpins remain the same. The only exception is the open structure with no hairpin at all. Since we need two types of algebra functions for hairpins (<code>hl</code> and <code>hlTag</code>) we also need special signatures and algebras, which are contained in the file &quot;macrostateCenter.gap&quot;