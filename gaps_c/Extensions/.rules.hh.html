<p>&quot;rules.hh&quot; is a special data-type for TDM generation. It holds all rules of a grammar in an unique way, i.e. even if the generator adds twice the rules for a simple hairpin it will appear only once in the generated grammar. This is accomplished by using a two level hash. First level is for non-terminals, second level for alternatives of a non-terminal. </p>
<p>For TDMs the rules must be indexed. We do so by using sub-shape strings, but have to convert <code>[</code> to <code>L</code> and <code>]</code> to <code>J</code> characters to fit GAP-L's requirements for valid non-terminal identifiers. Besides the two level hash, the sub-shape string is the second component of the <code>rules</code> data type. A special situation occurs for concatenating two level 1 sub-shapes. There interface might hold unpaired bases (<code>_</code>), but of course their concatenation must be <code>_</code> and not <code>__</code>. Ensuring this is the task of function <code>appendShape</code>.
</p>
<p>Please have a look at the application <a href="?id=Rapidshapes">RapidShapes</a>, to see TDMs in action.</p>